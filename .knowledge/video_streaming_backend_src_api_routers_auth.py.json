{"is_source_file": true, "format": "Python", "description": "This is a Python source file defining authentication API routes using FastAPI. It includes endpoints for user registration, login, token refresh, and logout, handling JWT tokens, refresh tokens, and user session management.", "external_files": ["src/api/schemas/auth", "src/db/models", "src/db/session", "src.security.jwt", "src.security.passwords", "src.settings"], "external_methods": ["create_access_token", "hash_password", "verify_password", "get_settings"], "published": ["router"], "classes": [{"name": "RefreshToken", "description": "ORM model representing refresh tokens stored in the database."}, {"name": "User", "description": "ORM model representing user accounts."}, {"name": "UserRole", "description": "Enum or class defining user roles."}], "methods": [{"name": "TokenPairResponse register(payload: RegisterRequest, db: Session = Depends(get_db))", "description": "Endpoint to register a new user, create user record, and issue tokens.", "scope": "", "scopeKind": ""}, {"name": "TokenPairResponse login(payload: LoginRequest, db: Session = Depends(get_db))", "description": "Authenticates user credentials and issues access and refresh tokens.", "scope": "", "scopeKind": ""}, {"name": "TokenPairResponse refresh(payload: RefreshRequest, db: Session = Depends(get_db))", "description": "Refreshes access token by rotating refresh tokens after validation.", "scope": "", "scopeKind": ""}, {"name": "dict logout(payload: LogoutRequest, db: Session = Depends(get_db))", "description": "Revokes a refresh token, effectively logging out the user.", "scope": "", "scopeKind": ""}, {"name": "int _access_expires_in_seconds()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "User|None _get_user_by_email(db: Session, email: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "RefreshToken _issue_refresh_token(db: Session, user: User)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None _revoke_refresh_token(db: Session, rt: RefreshToken)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UserPublic _to_user_public(user: User)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TokenPairResponse _token_response(user: User, refresh_token: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "datetime _utcnow()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["create_access_token", "hash_password", "verify_password", "get_db", "select", "db.execute", "db.add", "db.flush", "db.commit", "db.get", "get_settings"], "search-terms": ["auth", "JWT", "refresh token", "FastAPI auth routes", "token rotation", "user registration", "login endpoint"], "state": 2, "file_id": 19, "knowledge_revision": 44, "git_revision": "6371df18a76adb37eb47c9e3f201b1944a009ddf", "ctags": [{"_type": "tag", "name": "_access_expires_in_seconds", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _access_expires_in_seconds() -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_get_user_by_email", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _get_user_by_email(db: Session, email: str) -> User | None:$/", "language": "Python", "typeref": "typename:User|None", "kind": "function", "signature": "(db: Session, email: str)"}, {"_type": "tag", "name": "_issue_refresh_token", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _issue_refresh_token(db: Session, user: User) -> RefreshToken:$/", "language": "Python", "typeref": "typename:RefreshToken", "kind": "function", "signature": "(db: Session, user: User)"}, {"_type": "tag", "name": "_revoke_refresh_token", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _revoke_refresh_token(db: Session, rt: RefreshToken) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(db: Session, rt: RefreshToken)"}, {"_type": "tag", "name": "_settings", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^_settings = get_settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_to_user_public", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _to_user_public(user: User) -> UserPublic:$/", "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(user: User)"}, {"_type": "tag", "name": "_token_response", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _token_response(user: User, refresh_token: str) -> TokenPairResponse:$/", "language": "Python", "typeref": "typename:TokenPairResponse", "kind": "function", "signature": "(user: User, refresh_token: str)"}, {"_type": "tag", "name": "_utcnow", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def _utcnow() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def login(payload: LoginRequest, db: Session = Depends(get_db)) -> TokenPairResponse:$/", "language": "Python", "typeref": "typename:TokenPairResponse", "kind": "function", "signature": "(payload: LoginRequest, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "logout", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def logout(payload: LogoutRequest, db: Session = Depends(get_db)) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(payload: LogoutRequest, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "refresh", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def refresh(payload: RefreshRequest, db: Session = Depends(get_db)) -> TokenPairResponse:$/", "language": "Python", "typeref": "typename:TokenPairResponse", "kind": "function", "signature": "(payload: RefreshRequest, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^def register(payload: RegisterRequest, db: Session = Depends(get_db)) -> TokenPairResponse:$/", "language": "Python", "typeref": "typename:TokenPairResponse", "kind": "function", "signature": "(payload: RegisterRequest, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/routers/auth.py", "pattern": "/^router = APIRouter(prefix=\"\\/api\\/auth\", tags=[\"Auth\"])$/", "language": "Python", "kind": "variable"}], "hash": "cc3a2d36b9c315b23d4b83c324b04891", "format-version": 4, "code-base-name": "video_streaming_backend", "filename": "video_streaming_backend/src/api/routers/auth.py", "fields": [{"name": "_settings = get_settings()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/api\\/auth\", tags=[\"Auth\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"44": "6371df18a76adb37eb47c9e3f201b1944a009ddf"}]}