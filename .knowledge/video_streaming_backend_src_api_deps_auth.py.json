{"is_source_file": true, "format": "Python", "description": "This file contains FastAPI dependencies related to authentication and authorization, including functions to retrieve the current user based on a JWT token and role-based access control.", "external_files": ["src/db/models", "src/db/session", "src.security.jwt"], "external_methods": ["decode_token", "get_db", "User.is_active"], "published": ["get_current_user", "require_roles"], "classes": [{"name": "User", "description": "A user model representing application users, including their role and activity status.", "attributes": ["role", "is_active"]}, {"name": "UserRole", "description": "An enumeration or similar construct representing user roles such as admin, user, etc."}], "methods": [{"name": "HTTPException _unauthorized(detail: str = \"Not authenticated\")", "description": "Creates an HTTPException for unauthorized access with status 401.", "scope": "", "scopeKind": ""}, {"name": "HTTPException _forbidden(detail: str = \"Not enough permissions\")", "description": "Creates an HTTPException for forbidden access with status 403.", "scope": "", "scopeKind": ""}, {"name": "User get_current_user( credentials: Annotated[HTTPAuthorizationCredentials | None, Security(_bearer)], db: Annotated[Session, Depends(get_db)], )", "description": "Dependency that decodes the JWT token from the Authorization header to retrieve and return the current User object.", "scope": "", "scopeKind": ""}, {"name": "Callable[...,User] require_roles(*allowed_roles: UserRole)", "description": "Creates a dependency to ensure the current user has one of the allowed roles.", "scope": "", "scopeKind": ""}, {"name": "User _dep(user: Annotated[User, Depends(get_current_user)])", "scope": "require_roles", "scopeKind": "function", "description": "unavailable"}], "calls": ["decode_token", "get_db", "User.is_active"], "search-terms": ["auth dependencies", "JWT token decoding", "FastAPI security", "role-based access control", "get_current_user"], "state": 2, "file_id": 18, "knowledge_revision": 43, "git_revision": "6371df18a76adb37eb47c9e3f201b1944a009ddf", "ctags": [{"_type": "tag", "name": "_bearer", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/deps/auth.py", "pattern": "/^_bearer = HTTPBearer(auto_error=False)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_dep", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/deps/auth.py", "pattern": "/^    def _dep(user: Annotated[User, Depends(get_current_user)]) -> User:$/", "file": true, "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(user: Annotated[User, Depends(get_current_user)])", "scope": "require_roles", "scopeKind": "function"}, {"_type": "tag", "name": "_forbidden", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/deps/auth.py", "pattern": "/^def _forbidden(detail: str = \"Not enough permissions\") -> HTTPException:$/", "language": "Python", "typeref": "typename:HTTPException", "kind": "function", "signature": "(detail: str = \"Not enough permissions\")"}, {"_type": "tag", "name": "_unauthorized", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/deps/auth.py", "pattern": "/^def _unauthorized(detail: str = \"Not authenticated\") -> HTTPException:$/", "language": "Python", "typeref": "typename:HTTPException", "kind": "function", "signature": "(detail: str = \"Not authenticated\")"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/deps/auth.py", "pattern": "/^def get_current_user($/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "( credentials: Annotated[HTTPAuthorizationCredentials | None, Security(_bearer)], db: Annotated[Session, Depends(get_db)], )"}, {"_type": "tag", "name": "require_roles", "path": "/home/kavia/workspace/code-generation/streamview-platform-307320-307329/video_streaming_backend/src/api/deps/auth.py", "pattern": "/^def require_roles(*allowed_roles: UserRole) -> Callable[..., User]:$/", "language": "Python", "typeref": "typename:Callable[...,User]", "kind": "function", "signature": "(*allowed_roles: UserRole)"}], "hash": "b100ffc4344912d097999d0fbb483485", "format-version": 4, "code-base-name": "video_streaming_backend", "filename": "video_streaming_backend/src/api/deps/auth.py", "fields": [{"name": "_bearer = HTTPBearer(auto_error=False)", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"43": "6371df18a76adb37eb47c9e3f201b1944a009ddf"}]}